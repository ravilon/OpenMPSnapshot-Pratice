#include <stdio.h>
#include <omp.h>

#define N 1000

void insertion_sort();
int binary_search(int arr[], int search_element);

int arr[] = {262,16,428,9,834,31,535,355,46,265,68,325,643,75,75,515,69,210,261,881,93,589,986,172,208,223,709,976,416,863,823,989,348,640,368,813,63,977,117,7,639,673,535,850,851,821,248,668,825,591,836,87,262,738,906,840,248,610,94,982,393,726,609,589,43,703,566,969,402,557,542,409,471,961,133,485,618,753,584,477,697,465,908,846,489,324,659,324,552,604,775,498,393,758,424,44,12,866,891,675,434,360,711,240,18,49,38,761,962,3,381,839,553,768,926,774,545,46,541,231,670,660,218,536,945,134,804,552,747,964,922,614,378,805,132,214,689,12,725,402,327,891,561,837,264,358,654,469,173,460,270,778,215,415,666,97,271,312,694,675,138,300,176,142,142,477,128,659,79,977,899,576,828,718,331,286,615,680,942,479,804,808,805,520,101,207,951,81,53,240,156,815,776,878,175,191,137,77,661,420,137,339,639,262,311,517,405,110,56,599,992,685,668,232,163,121,126,288,67,227,805,394,374,491,852,772,893,360,57,817,688,868,889,56,205,848,106,940,107,668,631,676,665,972,683,281,417,834,903,19,116,218,617,451,696,64,108,915,798,477,740,385,66,78,966,666,487,626,954,977,253,798,96,448,365,820,703,18,519,873,710,710,308,187,879,82,644,743,176,567,703,934,110,137,666,419,974,635,489,69,170,902,849,382,742,348,190,876,502,46,378,480,501,781,206,795,707,422,440,794,53,268,361,335,838,86,351,80,649,177,290,557,743,203,743,88,887,979,666,550,834,847,692,50,255,613,344,752,552,365,61,380,526,603,976,131,310,527,758,687,571,610,984,403,65,257,540,924,616,962,29,552,179,96,796,632,46,719,844,811,821,996,438,259,489,89,375,40,512,172,879,174,395,110,104,647,917,173,601,400,31,368,454,419,178,608,430,864,186,578,219,351,91,906,448,669,407,551,633,915,872,276,116,900,216,769,34,666,752,557,696,722,904,715,488,998,270,195,265,840,233,643,43,214,112,466,341,972,691,720,707,745,357,658,529,982,275,36,962,628,9,21,675,162,830,523,807,849,974,486,742,281,411,211,614,545,996,287,945,569,104,505,425,602,856,6,986,630,65,56,468,725,949,66,231,898,475,483,968,597,833,439,655,825,743,591,880,922,66,86,845,569,923,618,439,35,796,733,263,774,267,322,273,123,44,765,855,870,832,415,641,570,841,479,958,340,961,167,761,552,74,247,409,961,533,394,807,958,121,382,150,791,908,903,641,643,729,759,592,10,818,129,855,934,290,559,94,103,957,555,62,992,281,749,93,135,926,589,192,990,698,764,687,77,966,334,526,817,586,58,617,371,555,898,886,515,694,647,780,294,777,526,875,972,862,869,779,292,423,879,580,814,839,719,610,766,210,547,699,898,18,844,631,515,967,982,845,330,250,42,769,230,615,873,290,298,564,887,208,318,538,703,885,221,23,317,201,137,292,550,915,682,458,288,552,82,386,954,500,872,541,303,500,523,504,668,584,446,844,976,567,432,57,741,116,387,805,680,112,930,148,542,158,326,73,533,272,930,303,950,123,737,628,968,6,313,140,661,542,417,604,419,690,355,80,680,741,90,960,167,582,827,803,557,7,119,632,192,562,994,37,907,12,950,875,980,498,332,10,960,966,9,775,824,911,319,19,343,475,485,848,830,218,118,278,389,317,164,388,559,963,644,398,143,953,21,782,826,909,872,54,295,722,52,623,572,439,384,155,719,163,46,368,37,535,679,897,371,612,345,685,270,907,781,397,455,149,721,321,610,679,21,321,132,795,298,477,327,71,704,461,354,695,345,49,685,443,594,528,827,136,91,13,642,894,713,178,176,16,440,799,372,217,738,722,831,268,783,712,726,82,700,796,761,405,785,51,362,579,697,294,262,727,14,659,422,405,839,662,188,537,90,105,686,207,118,832,482,178,500,535,309,380,696,787,8,660,793,481,883,76,578,549,141,646,589,129,80,5,881,216,657,72,854,473,37,569,390,812,29,730,955,675,856,401,67,7,94,627,835,886,671,776,312,791,725,217,467,306,464,225,899,483,181,917,368,905,192,888,822,664,65,263,553,895,507,777,155,439,421,615,35,121,78,343,370,93,312,411,448,877,61,546,731,328,621,62,645,191,945,396,594,649,996,699,754,448,130,795,923,704,878,275,549,633,68,718,0,439,750,128,467,622,482,197,582,827,81,525,120,422,288,520,258,537,511,62,961,659,410,218,754,927,91,226,336,959,581,367,399};
int search_element = 881;

int main() {
    insertion_sort();
    
    double start_time = omp_get_wtime();
    int result = binary_search(arr, search_element);
    double end_time = omp_get_wtime();

    double execution_time = end_time - start_time;

    if (result) {
        printf("%d is in the array. \n", search_element);
    } else {
        printf("%d is not in array. \n", search_element);
    }
    printf("Time taken = %f s \n", execution_time);

    return 0;
}

int binary_search(int arr[], int search_element) {
    int found = 0;

    #pragma omp parallel num_threads(6)
    {
        int id = omp_get_thread_num();
        int num_threads = omp_get_num_threads(); 
        int segment = N / num_threads;

        int left = id*segment;
        int right = (id+1)*segment - 1;
        if (id+1 == num_threads){
            right = N-1;
        }

        while (left <= right && !found) {
            int mid = (left + right) / 2;
            if (arr[mid] == search_element) {
                #pragma omp atomic write
                found = 1;
                #pragma omp cancellation point parallel
            } else if (arr[mid] < search_element) {
                left = mid + 1;
            } else {
                right = mid - 1;
            }
        }
    }

    return found;
}

void insertion_sort(){
    for (int i=1; i<N; i++){
        int pivot = arr[i];
        int j = i-1;

        while (j>=0 && arr[j]>pivot) {
            arr[j+1] = arr[j];
            j--;
        }
        arr[j+1] = pivot;
    }
}